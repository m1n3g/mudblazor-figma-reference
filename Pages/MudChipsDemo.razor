@page "/components/chips"
@using MudBlazor

<!-- Controls Row: Variant & Size -->
<MudGrid Class="mb-2">
    <MudItem xs="12" sm="6">
        <MudSelect T="Variant" Label="Variant" @bind-Value="_variant" Dense="true">
            <MudSelectItem Value="@Variant.Filled">Filled</MudSelectItem>
            <MudSelectItem Value="@Variant.Outlined">Outlined</MudSelectItem>
            <MudSelectItem Value="@Variant.Text">Text</MudSelectItem>
        </MudSelect>
    </MudItem>
    <MudItem xs="12" sm="6">
        <MudSelect T="Size" Label="Size" @bind-Value="_size" Dense="true">
            <MudSelectItem Value="@Size.Small">Small</MudSelectItem>
            <MudSelectItem Value="@Size.Medium">Medium</MudSelectItem>
            <MudSelectItem Value="@Size.Large">Large</MudSelectItem>
        </MudSelect>
    </MudItem>
</MudGrid>

<!-- Toggles Row -->
<MudStack Row Spacing="2" Class="mb-3 align-center">
    <MudCheckBox @bind-Value="_label" Label="Label (pill style)" />
    <MudCheckBox @bind-Value="_closable" Label="Closable" />
</MudStack>

<!-- Icon & Avatar selection -->
<MudGrid Class="mb-3">
    <MudItem xs="12" sm="6">
        <MudSelect T="string" Label="Icon (for Icon chip)" @bind-Value="_icon" Dense="true">
            <MudSelectItem Value="@Icons.Material.Filled.Star">Star</MudSelectItem>
            <MudSelectItem Value="@Icons.Material.Filled.Favorite">Favorite</MudSelectItem>
            <MudSelectItem Value="@Icons.Material.Filled.CheckCircle">CheckCircle</MudSelectItem>
            <MudSelectItem Value="@Icons.Material.Filled.Bolt">Bolt</MudSelectItem>
            <MudSelectItem Value="@Icons.Material.Filled.Pets">Pets</MudSelectItem>
        </MudSelect>
    </MudItem>
    <MudItem xs="12" sm="6">
        <MudSelect T="string" Label="Avatar mode" @bind-Value="_avatarMode" Dense="true">
            <MudSelectItem Value="@("Initials")">Initials</MudSelectItem>
            <MudSelectItem Value="@("Image")">Image</MudSelectItem>
            <MudSelectItem Value="@("None")">None</MudSelectItem>
        </MudSelect>
    </MudItem>
</MudGrid>

<MudDivider Class="mb-3" />

<!-- Preview: a few chips showing the features -->
<MudStack Row Spacing="1" Class="mb-4 align-center">

    <!-- Plain chip -->
    <MudChip T="string" Value="@("Primary")" Variant="_variant" Size="_size" Label="_label" Color="Color.Primary"
        Closeable="_closable" OnClose="@(() => RemoveChip("Primary"))">
        Primary
    </MudChip>

    <!-- Icon chip -->
    <MudChip T="string" Value="@("Icon")" Variant="_variant" Size="_size" Label="_label" Color="Color.Secondary"
        Closeable="_closable" OnClose="@(() => RemoveChip("Icon"))">
        <MudIcon Icon="@_icon" Class="mr-1" />
        Icon
    </MudChip>

    <!-- Avatar chip -->
    <MudChip T="string" Value="@("Avatar")" Variant="_variant" Size="_size" Label="_label" Color="Color.Info"
        Closeable="_closable" OnClose="@(() => RemoveChip("Avatar"))">
        @if (_avatarMode == "Initials")
        {
            <MudAvatar Class="mr-1" Size="@(_size == Size.Small ? Size.Small : Size.Medium)">AS</MudAvatar>
        }
        else if (_avatarMode == "Image")
        {
            <MudAvatar Class="mr-1" Size="@(_size == Size.Small ? Size.Small : Size.Medium)">
                <MudImage Src="images/mony.jpg" Alt="avatar" />
            </MudAvatar>
        }
        Avatar
    </MudChip>

    <!-- Success chip -->
    <MudChip T="string" Value="@("Success")" Variant="_variant" Size="_size" Label="_label" Color="Color.Success"
        Closeable="_closable" OnClose="@(() => RemoveChip("Success"))">
        <MudIcon Icon="@Icons.Material.Filled.Check" Class="mr-1" />
        Success
    </MudChip>

    <!-- Danger chip -->
    <MudChip T="string" Value="@("Danger")" Variant="_variant" Size="_size" Label="_label" Color="Color.Error"
        Closeable="_closable" OnClose="@(() => RemoveChip("Danger"))">
        <MudIcon Icon="@Icons.Material.Filled.Warning" Class="mr-1" />
        Danger
    </MudChip>
</MudStack>

<!-- Dynamic list of closable chips -->
<MudText Typo="Typo.subtitle2" Class="mb-1">Dynamic chips</MudText>
<MudStack Row Spacing="1" Class="align-center">
    @foreach (var chip in _chips)
    {
        <MudChip T="string" Value="@chip" Variant="_variant" Size="_size" Label="_label" Color="Color.Dark"
            Closeable="_closable" OnClose="@(() => RemoveFromList(chip))">
            @chip
        </MudChip>
    }
</MudStack>

<!-- Add chip to dynamic list -->
<MudStack Row Spacing="2" Class="mt-6 align-center">
    <MudTextField @bind-Value="_newChip" Placeholder="Add a chip..." Dense="true" />
    <MudButton Variant="Variant.Filled" Color="Color.Primary" OnClick="AddToList"
        StartIcon="@Icons.Material.Filled.Add">Add</MudButton>
</MudStack>

@code {
    private Variant _variant = Variant.Filled;
    private Size _size = Size.Medium;
    private bool _label = false;
    private bool _closable = true;

    private string _icon = Icons.Material.Filled.Star;
    private string _avatarMode = "Initials"; // "Initials" | "Image" | "None"

    private List<string> _chips = new() { "Alpha", "Beta", "Gamma" };
    private string? _newChip;

    private void RemoveChip(string _which) { /* demo: static chips not removed */ }

    private void AddToList()
    {
        var text = _newChip?.Trim();
        if (string.IsNullOrWhiteSpace(text)) return;
        if (!_chips.Contains(text))
            _chips.Add(text);
        _newChip = string.Empty;
    }

    private void RemoveFromList(string chip) => _chips.Remove(chip);
}
