@page "/components/avatar"
@using MudBlazor

<MudText Typo="Typo.h6" Style="font-weight:700">Avatar Playground</MudText>

<MudPaper Class="pa-6 my-3" Elevation="0">
    <MudGrid>
        <!-- Controls -->
        <MudItem xs="12" md="4">
            <MudStack Spacing="2">
                <MudSelect T="Variant" Label="Variant" @bind-Value="_variant">
                    <MudSelectItem Value="Variant.Text">Text</MudSelectItem>
                    <MudSelectItem Value="Variant.Filled">Filled</MudSelectItem>
                    <MudSelectItem Value="Variant.Outlined">Outlined</MudSelectItem>
                </MudSelect>

                <!-- Text input is always enabled now -->
                <MudTextField Label="Text" @bind-Value="_text" />

                <MudSelect T="Color" Label="Color" @bind-Value="_color">
                    <MudSelectItem Value="Color.Default">Default</MudSelectItem>
                    <MudSelectItem Value="Color.Primary">Primary</MudSelectItem>
                    <MudSelectItem Value="Color.Secondary">Secondary</MudSelectItem>
                    <MudSelectItem Value="Color.Tertiary">Tertiary</MudSelectItem>
                    <MudSelectItem Value="Color.Info">Info</MudSelectItem>
                    <MudSelectItem Value="Color.Success">Success</MudSelectItem>
                    <MudSelectItem Value="Color.Warning">Warning</MudSelectItem>
                    <MudSelectItem Value="Color.Error">Error</MudSelectItem>
                    <MudSelectItem Value="Color.Dark">Dark</MudSelectItem>
                </MudSelect>

                <MudSelect T="Size" Label="Size" @bind-Value="_size">
                    <MudSelectItem Value="Size.Small">Small</MudSelectItem>
                    <MudSelectItem Value="Size.Medium">Medium</MudSelectItem>
                    <MudSelectItem Value="Size.Large">Large</MudSelectItem>
                </MudSelect>

                <!-- Shape dropdown: Default (circle), Rounded, Square -->
                <MudSelect T="AvatarShape" Label="Shape" @bind-Value="_shape">
                    <MudSelectItem Value="AvatarShape.Default">Default</MudSelectItem>
                    <MudSelectItem Value="AvatarShape.Rounded">Rounded</MudSelectItem>
                    <MudSelectItem Value="AvatarShape.Square">Square</MudSelectItem>
                </MudSelect>

                <MudDivider Class="my-2" />
                <!-- Badge controls were removed previously -->
            </MudStack>
        </MudItem>

        <!-- Previews -->
        <MudItem xs="12" md="8">
            <!-- FIX: Use MudGrid (not MudStack) so MudItem children are valid -->
            <MudGrid Justify="Justify.FlexEnd" AlignItems="AlignItems.Center">
                <MudItem xs="3" md="3">
                    <MudText Typo="Typo.subtitle2" Class="mb-2">Live Preview (Text)</MudText>
                    <MudPaper Class="pa-6 d-inline-block" Elevation="1">
                        @AvatarText()
                    </MudPaper>
                </MudItem>

                <MudItem xs="3" md="3">
                    <MudText Typo="Typo.subtitle2" Class="mb-2">Live Preview (Icon)</MudText>
                    <MudPaper Class="pa-6 d-inline-block" Elevation="1">
                        <MudAvatar Color="@_color" Variant="@_variant" Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            <MudIcon Icon="@_icon" />
                        </MudAvatar>
                    </MudPaper>
                </MudItem>

                <MudItem xs="3" md="3">
                    <MudText Typo="Typo.subtitle2" Class="mb-2">Live Preview (Image)</MudText>
                    <MudPaper Class="pa-6 d-inline-block" Elevation="1">
                        <!-- IMAGE PREVIEW LEFT UNCHANGED -->
                        <MudAvatar Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            <MudImage Src="images/mony.jpg" />
                        </MudAvatar>
                    </MudPaper>
                </MudItem>

                <MudItem xs="3" md="3">
                    <MudText Typo="Typo.subtitle2" Class="mb-2">Live Preview (Badges)</MudText>
                    <MudPaper Class="pa-6 d-inline-block" Elevation="1">
                        <MudBadge Color="Color.Error" Icon="@Icons.Material.Filled.Remove" Overlap="true" Bordered="true">
                            <MudAvatar Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                                <MudImage Src="images/mony.jpg" />
                            </MudAvatar>
                        </MudBadge>
                    </MudPaper>
                </MudItem>
            </MudGrid>

            <MudGrid>
                <MudItem xs="12" sm="12">
                    <MudText Typo="Typo.subtitle2" Class="mt-6 mb-2">Group Preview</MudText>
                    <MudAvatarGroup Max="@_groupMax" Spacing="@_groupSpacing" MaxColor="Color.Primary">
                        <MudAvatar Color="Color.Primary" Variant="@_variant" Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            @_text
                        </MudAvatar>
                        <MudAvatar Color="Color.Secondary" Variant="@_variant" Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            U
                        </MudAvatar>
                        <MudAvatar Color="Color.Tertiary" Variant="@_variant" Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            D
                        </MudAvatar>
                        <MudAvatar Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            <MudImage Src="images/mony.jpg" />
                        </MudAvatar>
                        <MudAvatar Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            <MudImage Src="images/castle.jpg" />
                        </MudAvatar>
                        <MudAvatar Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
                            <MudImage Src="images/sweden.jpg" />
                        </MudAvatar>
                    </MudAvatarGroup>
                </MudItem>

                <MudItem xs="12" sm="12">
                    <MudGrid>
                        <MudItem xs="12" sm="6">
                            <MudSlider Min="0" Max="6" Step="0" @bind-Value="_groupMax" Color="Color.Primary">
                                Max Avatars
                            </MudSlider>
                        </MudItem>
                        <MudItem xs="12" sm="6">
                            <MudSlider Min="0" Max="16" Step="0" @bind-Value="_groupSpacing" Color="Color.Info">
                                Spacing
                            </MudSlider>
                        </MudItem>
                    </MudGrid>
                </MudItem>
            </MudGrid>
        </MudItem>
    </MudGrid>
</MudPaper>

@code {
    private Variant _variant = Variant.Filled;

    private string _text = "M";
    private readonly string _icon = Icons.Material.Filled.Person;

    private Color _color = Color.Primary;
    private Size _size = Size.Medium;

    // Shape
    private AvatarShape _shape = AvatarShape.Default; // Default = circle
    private bool IsSquare => _shape == AvatarShape.Square;
    private bool IsRounded => _shape == AvatarShape.Rounded;

    // Group
    private int _groupMax = 3;
    private int _groupSpacing = 0;

    // --- avatar renderer (text) ---
    private RenderFragment AvatarText() =>
        @<MudAvatar Color="@_color" Variant="@_variant" Size="@_size" Square="@(IsSquare)" Rounded="@(IsRounded)">
            @_text
        </MudAvatar>;

    private enum AvatarShape { Default, Rounded, Square } // Default = circle
}
