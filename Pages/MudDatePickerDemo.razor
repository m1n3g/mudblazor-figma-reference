@page "/components/datepicker"
@using System.Linq
@using MudBlazor

<MudGrid>
    <!-- Left: all variants — Start adornment -->
    <MudItem xs="12" md="4">
        <MudText Typo="Typo.subtitle1" Class="mb-2">Start adornment</MudText>
        <MudStack Spacing="4">
            @foreach (var variant in Enum.GetValues(typeof(Variant)).Cast<Variant>())
            {
                <MudDatePicker
                    @bind-Date="_dateStart"
                    Variant="variant"
                    Label="@variant.ToString()"
                    Margin="@ComputedMargin"
                    Disabled="@_disabled"
                    ReadOnly="@_readonly"
                    Placeholder="@(_placeholder ? "Select date" : null)"
                    HelperText="@(_helperText ? "Helper Text" : null)"
                    HelperTextOnFocus="@_helperTextOnFocus"
                    Clearable="@_clearable"
                    Error="@_hasError"
                    ErrorText="Please pick a date"
                    Immediate="true"
                    ShrinkLabel="@_shrinkLabel"
                    Adornment="Adornment.Start"
                    AdornmentIcon="@Icons.Material.Filled.Event" />
            }
        </MudStack>
    </MudItem>

    <!-- Middle: all variants — End adornment -->
    <MudItem xs="12" md="4">
        <MudText Typo="Typo.subtitle1" Class="mb-2">End adornment</MudText>
        <MudStack Spacing="4">
            @foreach (var variant in Enum.GetValues(typeof(Variant)).Cast<Variant>())
            {
                <MudDatePicker
                    @bind-Date="_dateEnd"
                    Variant="variant"
                    Label="@($"{variant} (End)")"
                    Margin="@ComputedMargin"
                    Disabled="@_disabled"
                    ReadOnly="@_readonly"
                    Placeholder="@(_placeholder ? "Select date" : null)"
                    HelperText="@(_helperText ? "Helper Text" : null)"
                    HelperTextOnFocus="@_helperTextOnFocus"
                    Clearable="@_clearable"
                    Error="@_hasError"
                    ErrorText="Please pick a date"
                    Immediate="true"
                    ShrinkLabel="@_shrinkLabel"
                    Adornment="Adornment.End"
                    AdornmentIcon="@Icons.Material.Filled.EditCalendar" />
            }
        </MudStack>
    </MudItem>

    <!-- Right: extras + Margin picker -->
    <MudItem xs="12" md="4">
        <MudStack Spacing="3">
            <MudText Typo="Typo.subtitle1">Extras</MudText>

            <MudDatePicker
                Label="Filled + Helper"
                Variant="Variant.Filled"
                Margin="@ComputedMargin"
                HelperText="@(_helperText ? "Pick any date" : null)"
                Immediate="true"
                ShrinkLabel="@_shrinkLabel"
                Adornment="Adornment.Start"
                AdornmentIcon="@Icons.Material.Filled.Today"
                @bind-Date="_dateExtra1" />

            <MudDatePicker
                Label="Outlined + End text"
                Variant="Variant.Outlined"
                Margin="@ComputedMargin"
                Clearable="@_clearable"
                Immediate="true"
                ShrinkLabel="@_shrinkLabel"
                Adornment="Adornment.End"
                AdornmentText="UTC"
                @bind-Date="_dateExtra2" />

            <MudSelect T="Margin" @bind-Value="_margin" Label="Margin">
                @foreach (var m in Enum.GetValues(typeof(Margin)).Cast<Margin>())
                {
                    <MudSelectItem Value="m">@m</MudSelectItem>
                }
            </MudSelect>
        </MudStack>
    </MudItem>
</MudGrid>

<!-- Controls row (same knobs as TextField/ColorPicker) -->
<MudDivider Class="my-4" />
<MudStack Row Spacing="3" AlignItems="AlignItems.Center">
    <MudSwitch @bind-Value="_dense" Label="Dense" Color="Color.Primary" />
    <MudSwitch @bind-Value="_readonly" Label="ReadOnly" Color="Color.Primary" />
    <MudSwitch @bind-Value="_disabled" Label="Disabled" Color="Color.Primary" />
    <MudSwitch @bind-Value="_placeholder" Label="Placeholder" Color="Color.Primary" />
    <MudSwitch @bind-Value="_helperText" Label="HelperText" Color="Color.Primary" />
    <MudSwitch @bind-Value="_helperTextOnFocus" Label="HelperTextOnFocus" Color="Color.Primary" />
    <MudSwitch @bind-Value="_clearable" Label="Clearable" Color="Color.Primary" />
    <MudSwitch @bind-Value="_hasError" Label="Show Error" Color="Color.Error" />
    <MudSwitch @bind-Value="_shrinkLabel" Label="ShrinkLabel" Color="Color.Primary" />
</MudStack>

<!-- ===== Picker panel (remains at bottom) ===== -->
<MudDivider Class="my-6" />
<MudText Typo="Typo.h6">Picker panel</MudText>

<MudGrid Gutter="Size.Medium" Class="mt-2">
    <MudItem md="8" Class="d-flex justify-center">
        <MudDatePicker
            PickerVariant="PickerVariant.Static"
            @bind-Date="_panelDate"
            ShowToolbar="@PanelShowToolbar"
            AutoClose="@PanelAutoClose"
            OpenTo="@PanelOpenTo"
            Orientation="@PanelOrientation"
            DisplayMonths="@PanelDisplayMonths"
            MaxMonthColumns="@PanelMaxMonthColumns"
            ShowWeekNumbers="@PanelShowWeekNumbers"
            Class="pa-2" />
    </MudItem>

    <MudItem md="4">
        <MudPaper Height="460px" Class="px-4 pt-2 pb-4">
            <MudText Typo="Typo.h6">Options</MudText>

            <MudCheckBox @bind-Value="PanelShowToolbar"      Label="Show Toolbar"      Color="Color.Primary" Dense="true" />
            <MudCheckBox @bind-Value="PanelAutoClose"        Label="Auto Close"        Color="Color.Primary" Dense="true" />
            <MudCheckBox @bind-Value="PanelShowWeekNumbers"  Label="Show Week Numbers" Color="Color.Primary" Dense="true" />

            <MudSelect T="OpenTo" @bind-Value="PanelOpenTo" Label="Open To" Variant="Variant.Outlined" Dense="true" Margin="Margin.Dense" Class="mt-3">
                <MudSelectItem Value="OpenTo.Date">Date</MudSelectItem>
                <MudSelectItem Value="OpenTo.Month">Month</MudSelectItem>
                <MudSelectItem Value="OpenTo.Year">Year</MudSelectItem>
            </MudSelect>

            <MudSelect T="Orientation" @bind-Value="PanelOrientation" Label="Orientation" Variant="Variant.Outlined" Dense="true" Margin="Margin.Dense" Class="mt-3">
                <MudSelectItem Value="Orientation.Portrait">Portrait</MudSelectItem>
                <MudSelectItem Value="Orientation.Landscape">Landscape</MudSelectItem>
            </MudSelect>

            <MudNumericField T="int" @bind-Value="PanelDisplayMonths" Label="Display Months" Min="1" Max="12" Dense="true" Margin="Margin.Dense" Class="mt-3" />
            <MudNumericField T="int" @bind-Value="PanelMaxMonthColumns" Label="Max Month Columns" Min="1" Max="12" Dense="true" Margin="Margin.Dense" Class="mt-2" />

            <MudText Class="mt-3" Typo="Typo.caption">Selected: @(_panelDate?.ToString("yyyy-MM-dd") ?? "—")</MudText>
        </MudPaper>
    </MudItem>
</MudGrid>

@code {
    // top section values
    private DateTime? _dateStart = DateTime.Today;
    private DateTime? _dateEnd   = DateTime.Today;
    private DateTime? _dateExtra1;
    private DateTime? _dateExtra2;

    // switches (shared)
    private bool _dense, _disabled, _readonly, _placeholder, _helperText, _helperTextOnFocus, _clearable, _hasError, _shrinkLabel;

    // margin selection + computed margin honoring "Dense"
    private Margin _margin = Margin.None;
    private Margin ComputedMargin => _dense ? Margin.Dense : _margin;

    // bottom panel state
    private DateTime? _panelDate = DateTime.Today;

    public bool PanelShowToolbar { get; set; } = true;
    public bool PanelAutoClose { get; set; } = true;
    public bool PanelShowWeekNumbers { get; set; } = false;

    public OpenTo      PanelOpenTo { get; set; } = OpenTo.Date;
    public Orientation PanelOrientation { get; set; } = Orientation.Portrait;

    public int PanelDisplayMonths { get; set; } = 1;
    public int PanelMaxMonthColumns { get; set; } = 1;
}
